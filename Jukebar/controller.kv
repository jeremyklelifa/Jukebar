#:kivy 1.0
#:import label kivy.uix.label
#:import lv kivy.uix.listview
#:import sla kivy.adapters.simplelistadapter
#:import la kivy.adapters.listadapter


<LoadDialog>:
    BoxLayout:
        size: root.size
        pos: root.pos
        orientation: "vertical"
        FileChooserListView:
            id: filechooser
            path: root.path

        BoxLayout:
            size_hint_y: None
            height: 30
            Button:
                text: "Cancel"
                on_release: root.cancel()

            Button:
                text: "Load"
                on_release: root.load(filechooser.path, filechooser.selection)

<SettingScreen@Screen>:
    timer_min_property: timer_min_id
    timer_max_property: timer_max_id
    cut_songs_lv_property: cut_songs_lv_id

    BoxLayout:
        orientation: 'vertical'

        Button:
            text: u'Back'
            on_press:
                root.manager.current = 'menu'
                root.manager.transition.direction = 'left'

        ListView:
            id: cut_songs_lv_id
            adapter:
                la.ListAdapter(
                data=root.cut_songs_property,
                cls=lv.ListItemButton)

        BoxLayout:
            orientation: 'horizontal'

            Button:
                text: u'+'
                on_press: root.show_load()

            Button:
                text: u'-'
                on_press: root.delete_music()

        BoxLayout:
            orientation: 'horizontal'
            spacing: 10
            Label:
                markup: True
                text: '[size=30][b][color=FFFFFF]Timer:[/color][/b][/size]'
            TextInput:
                id: timer_min_id
                text: '1'
            TextInput:
                id: timer_max_id
                text: '10'

<AboutScreen@Screen>:
    BoxLayout:
        orientation: 'vertical'

        Button:
            text: u'Back'
            on_press:
                root.manager.current = 'menu'
                root.manager.transition.direction = 'left'

        Label:
            markup: True
            text: '[size=45][b][color=00BFFF]Jukebar for drinkers[/color][/b][/size]\nNew line.'

<MenuScreen@Screen>:
    BoxLayout:
        orientation: 'vertical'

        Button:
            text: u'Back'
            on_press:
                root.manager.current = 'main'
                root.manager.transition.direction = 'left'

        Button:
            text: u'Settings'
            on_press:
                root.manager.current = 'setting'
                root.manager.transition.direction = 'right'

        Button:
            text: u'About'
            on_press:
                root.manager.current = 'about'
                root.manager.transition.direction = 'right'

        Button:
            text: u'Close'
            # TODO: stop running threads
            on_press: app.stop()


<MainScreen@Screen>:
    toggle_juke_property: toggle_juke_id

    FloatLayout:

        AnchorLayout:
            anchor_x: 'left'
            anchor_y: 'top'
            Button:
                text: 'Settings'
                size: self.texture_size
                size_hint: None, None
                padding: 50, 50
                # on_press: root.on_settings_action()
                on_press:
                    root.manager.current = 'menu'
                    root.manager.transition.direction = 'right'

        AnchorLayout:
            anchor_x: 'center'
            anchor_y: 'center'
            ToggleButton:
                id: toggle_juke_id
                text: 'Start Juke'
                size: self.texture_size
                size_hint: None, None
                padding: 50, 50
                on_state:
                    root.toggle_juke_action()


<Controller>:

    ScreenManager:

        MainScreen:
            id: main_screen_id
            name: 'main'

        MenuScreen:
            id: menu_screen_id
            name: 'menu'

        AboutScreen:
            id: about_screen_id
            name: 'about'

        SettingScreen:
            id: setting_screen_id
            name: 'setting'
